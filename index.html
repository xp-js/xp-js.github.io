<!DOCTYPE html>
<html lang="sk">
<head>
<meta charset="UTF-8">
<title>Windows XP Professional</title>
<link rel="stylesheet" href="https://unpkg.com/xp.css">

<style>
  :root { --taskbar-height: 30px; }

  * { user-select: none !important; -webkit-user-drag: none !important; }

  body, html { 
    margin: 0; padding: 0; width: 100%; height: 100%; 
    overflow: hidden; background: #000; font-family: Tahoma, sans-serif;
  }

  /* BOOT SEQUENCE */
  #boot-screen {
    position: fixed; inset: 0; background: #000 url('./img/startup.gif') center no-repeat;
    background-size: contain; z-index: 10000;
  }

  /* DESKTOP COMPONENTS (Skryt√© pre anim√°ciu) */
  #desktop { display: none; width: 100%; height: calc(100% - var(--taskbar-height)); position: relative; }
  #icons { opacity: 0; }
  #taskbar { display: none; opacity: 0; }

  /* MAXIMIZE FIX */
  .window.maximized { 
    width: 100vw !important; 
    height: calc(100vh - var(--taskbar-height)) !important; 
    top: 0 !important; left: 0 !important; 
    position: fixed !important;
  }

  .window { position: absolute; width: 400px; z-index: 100; display: flex; flex-direction: column; }
  .window.active { z-index: 2000 !important; }
  .window:not(.active) .title-bar { background: linear-gradient(to bottom, #7697e7 0%, #7e9ee9 100%) !important; }

  /* TASKBAR */
  #taskbar {
    position: absolute; bottom: 0; width: 100%; height: var(--taskbar-height);
    background: linear-gradient(to bottom, #245dda 0%, #1e52bd 100%);
    display: flex; align-items: center; z-index: 5000;
  }
  #start-button { width: 166px; height: 100%; background: url('./img/Windows XP Start Button.png') no-repeat center/contain; border: none; cursor: pointer; }

  /* MINESWEEPER */
  #mines-grid { display: grid; grid-template-columns: repeat(10, 20px); gap: 1px; background: #808080; border: 2px solid #fff; }
  .cell { width: 20px; height: 20px; background: #bdbdbd; border: 2px outset #eee; text-align: center; font-weight: bold; font-size: 12px; cursor: pointer; }
  .cell.revealed { border: 1px solid #7b7b7b; background: #bdbdbd; cursor: default; }

  /* CMD */
  .cmd-container { background: black; color: #dfdfdf; font-family: 'Consolas', monospace; height: 300px; padding: 10px; overflow-y: auto; }
  .cmd-input { background: transparent; border: none; color: white; outline: none; width: 80%; font-family: inherit; }

  /* GOODBYE */
  #goodbye-page {
    position: fixed; inset: 0; background: #003399; color: white;
    z-index: 30000; display: none; flex-direction: column; align-items: center; justify-content: center;
  }
</style>
</head>
<body onmousedown="handleFocus(event)">

<audio id="startup-sound" src="./img/Startup.mp3"></audio>

<div id="boot-screen"></div>

<div id="desktop">
  <div id="icons">
    <div class="desktop-icon" ondblclick="openApp('mycomputer', 'My Computer', './img/My Computer.webp')">
      <img src="./img/My Computer.webp"> My Computer
    </div>
    <div class="desktop-icon" ondblclick="openApp('mines', 'Minesweeper', './img/Minesweeper.png')">
      <img src="./img/Minesweeper.png"> Minesweeper
    </div>
    <div class="desktop-icon" ondblclick="openApp('cmd', 'Command Prompt', './img/CMD.png')">
      <img src="./img/CMD.png"> Command Prompt
    </div>
  </div>
  <div id="window-layer"></div>
</div>

<div id="start-menu" style="position:absolute; bottom:30px; left:0; width:300px; height:450px; background:#1e52bd; display:none; z-index:6000; flex-direction:column; border-radius:5px 5px 0 0;">
    <div style="height:50px; padding:10px; color:white; font-weight:bold; border-bottom:1px solid orange;">Administrator</div>
    <div style="flex-grow:1; background:white; padding:10px;">
        <div onclick="openApp('mines', 'Minesweeper', './img/Minesweeper.png')">Minesweeper</div>
    </div>
    <div style="height:40px; background:linear-gradient(to top, #1e52bd, #4485f6); display:flex; justify-content:flex-end; align-items:center; padding:0 10px;">
        <button onclick="startShutdown()" style="background:none; border:none; color:white; cursor:pointer;">Turn Off</button>
    </div>
</div>

<div id="taskbar">
  <button id="start-button" onclick="toggleStartMenu(event)"></button>
  <div id="taskbar-apps" style="flex-grow:1; display:flex; gap:5px;"></div>
  <div id="clock" style="color:white; padding:0 10px; opacity:0;">12:00</div>
</div>

<div id="goodbye-page">
  <h1 style="font-weight: 300; font-size: 3em;">Thank you for using XP.js.org!</h1>
  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Octicons-mark-github.svg/2048px-Octicons-mark-github.svg.png" width="80" style="margin:20px;">
  <p>Made by <strong>Adko5558 Services!</strong></p>
  <p><a href="https://github.com/xp-js/xp-js.github.io" style="color:white;">View Project on GitHub</a></p>
  <button style="margin-top:30px;" onclick="location.reload()">Restart XP</button>
</div>

<script>
  let zIndex = 1000;

  // 1. AUTENTICK√ù BOOT (8 SEK√öND)
  window.onload = () => {
    setTimeout(() => {
        document.getElementById('boot-screen').style.display = 'none';
        document.getElementById('desktop').style.display = 'block';
        
        // "Sekan√©" postupn√© naƒç√≠tavanie
        setTimeout(() => { 
            document.getElementById('startup-sound').play();
            document.getElementById('taskbar').style.display = 'flex';
            document.getElementById('taskbar').style.opacity = '1';
        }, 1000);
        
        setTimeout(() => { document.getElementById('icons').style.opacity = '1'; }, 2500);
        setTimeout(() => { document.getElementById('clock').style.opacity = '1'; updateClock(); }, 4000);
        
    }, 6000);
  };

  function updateClock() {
    const d = new Date();
    document.getElementById('clock').innerText = d.getHours().toString().padStart(2,'0') + ":" + d.getMinutes().toString().padStart(2,'0');
    setTimeout(updateClock, 10000);
  }

  // 2. FOCUS SYSTEM
  function handleFocus(e) {
    const win = e.target.closest('.window');
    if (win) {
        document.querySelectorAll('.window').forEach(w => w.classList.remove('active'));
        win.classList.add('active');
        win.style.zIndex = ++zIndex;
    }
  }

  // 3. APLIK√ÅCIE
  function openApp(id, title, icon) {
    document.getElementById('start-menu').style.display = 'none';
    if(document.querySelector(`.window[data-id="${id}"]`)) return;

    const win = document.createElement('div');
    win.className = 'window active';
    win.setAttribute('data-id', id);
    win.style.left = '100px'; win.style.top = '100px';
    win.style.zIndex = ++zIndex;

    let content = '';
    if(id === 'mines') content = `<div style="padding:10px; background:#bdbdbd; text-align:center;"><div id="mines-grid"></div></div>`;
    else if(id === 'cmd') content = `<div class="cmd-container"><div class="hist">Microsoft Windows XP [Version 5.1.2600]<br>C:\\> type 'help' for commands.</div><div style="display:flex">C:\\> <input type="text" class="cmd-input" autofocus></div></div>`;
    else content = `<div style="padding:20px; background:white;">Error 404: Not Found</div>`;

    win.innerHTML = `
      <div class="title-bar" onmousedown="handleFocus({target:this.parentElement})">
        <div class="title-bar-text">${title}</div>
        <div class="title-bar-controls">
          <button aria-label="Maximize" onclick="this.parentElement.parentElement.parentElement.classList.toggle('maximized')"></button>
          <button aria-label="Close" onclick="this.parentElement.parentElement.parentElement.remove()"></button>
        </div>
      </div>
      <div class="window-body" style="margin:0; padding:0;">${content}</div>
    `;

    document.getElementById('window-layer').appendChild(win);
    if(id === 'mines') initMines();
    if(id === 'cmd') initCMD(win);
    makeDraggable(win);
  }

  // 4. MINESWEEPER LOGIKA
  function initMines() {
    const grid = document.getElementById('mines-grid');
    for(let i=0; i<100; i++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.onclick = () => {
            cell.classList.add('revealed');
            if(Math.random() < 0.15) { cell.innerText = 'üí£'; cell.style.background = 'red'; alert('GAME OVER'); initMines(); }
            else { cell.innerText = Math.floor(Math.random()*3); cell.style.color = 'blue'; }
        };
        grid.appendChild(cell);
    }
  }

  // 5. CMD PR√çKAZY
  function initCMD(win) {
    const input = win.querySelector('.cmd-input');
    const hist = win.querySelector('.hist');
    input.addEventListener('keydown', (e) => {
        if(e.key === 'Enter') {
            const v = input.value.toLowerCase();
            hist.innerHTML += `<br>C:\\> ${v}`;
            if(v === 'help') hist.innerHTML += '<br>Available: VER, CLS, EXIT, DATE, DIR';
            else if(v === 'ver') hist.innerHTML += '<br>Windows XP [Version 5.1.2600]';
            else if(v === 'cls') hist.innerHTML = 'Microsoft Windows XP [Version 5.1.2600]';
            else if(v === 'date') hist.innerHTML += '<br>' + new Date().toLocaleDateString();
            else if(v === 'dir') hist.innerHTML += '<br>Directory of C:\\ <br> 01/12/2025 14:00 <DIR> WINDOWS';
            input.value = '';
        }
    });
  }

  function startShutdown() {
    document.getElementById('desktop').style.display = 'none';
    document.getElementById('taskbar').style.display = 'none';
    document.getElementById('goodbye-page').style.display = 'flex';
  }

  function toggleStartMenu(e) { e.stopPropagation(); const sm = document.getElementById('start-menu'); sm.style.display = (sm.style.display==='none'?'flex':'none'); }

  function makeDraggable(win) {
    const bar = win.querySelector('.title-bar');
    bar.onmousedown = (e) => {
        if(win.classList.contains('maximized')) return;
        let ox = e.clientX - win.offsetLeft, oy = e.clientY - win.offsetTop;
        document.onmousemove = (ev) => { win.style.left = (ev.clientX - ox) + 'px'; win.style.top = (ev.clientY - oy) + 'px'; };
        document.onmouseup = () => document.onmousemove = null;
    };
  }
</script>
</body>
</html>
